# トミカ存在チェッカー 設計書

## 1. 概要
所有トミカの管理を行うアプリケーション。NFCタグを使用してトミカの情報を取得し、所有状況を管理する。

---

## 2. システム構成
### 2.1 使用技術
- **フロントエンド**: React Native
- **データベース**: Firebase Firestore
- **NFCタグ**: NTAG213
- **対応OS**: iOS、Android

### 2.2 アーキテクチャ
- **クライアントサイド**: React Nativeで構築。NFCタグの読み取り・書き込み、データ表示・編集を担当。
- **バックエンド**: Firebase Firestoreを使用してデータを管理。
- **NFC通信**: `react-native-nfc-manager`ライブラリを使用。

---

## 3. 機能詳細
### 3.1 トミカ情報の取得機能
- **概要**: NFCタグをスキャンしてトミカの情報を取得。
- **処理フロー**:
  1. ユーザーが「スキャン」ボタンを押下。
  2. NFCタグをスキャン。
  3. タグ内のデータを取得し、アプリ内で表示。

### 3.2 トミカ情報の保存機能
- **概要**: NFCタグから取得したトミカ情報をFirebase Firestoreに保存。
- **処理フロー**:
  1. NFCタグから取得したデータをアプリ内で確認。
  2. 保存ボタンを押下。
  3. Firebase Firestoreにデータを保存。

### 3.3 新規登録機能
- **概要**: 新しいトミカをデータベースに登録し、NFCタグに情報を書き込む。
- **処理フロー**:
  1. ユーザーがトミカ情報を入力。
  2. NFCタグに情報を書き込む。
  3. 書き込み成功後、Firebase Firestoreにデータを保存。

### 3.4 トミカ情報の一覧表示機能
- **概要**: 所有しているトミカの情報を一覧表示。
- **処理フロー**:
  1. Firebase Firestoreからデータを取得。
  2. 一覧画面に表示。

### 3.5 トミカ情報の編集機能
- **概要**: 登録済みのトミカ情報を編集。
- **処理フロー**:
  1. 編集画面で情報を変更。
  2. Firebase Firestoreに変更内容を保存。

### 3.6 トミカ情報の削除機能
- **概要**: 登録済みのトミカ情報を削除。
- **処理フロー**:
  1. 削除ボタンを押下。
  2. Firebase Firestoreから該当データを削除。

### 3.7 トミカ情報の検索機能
- **概要**: トミカ情報を名前やIDで検索。
- **処理フロー**:
  1. 検索バーにキーワードを入力。
  2. Firebase Firestoreから該当データを取得し表示。

### 3.8 トミカ持ち出し機能
- **概要**: トミカの持ち出し状況を管理。
- **処理フロー**:
  1. 持ち出しボタンを押下してトミカを登録。
  2. 持ち出し中のトミカを一覧表示。
  3. 帰宅時に持ち出したトミカが全て揃っているか確認。

---

## 4. データベース設計
### 4.1 コレクション: `Tomica`
| フィールド名       | 型          | 説明                     |
|--------------------|-------------|--------------------------|
| `id`               | String      | トミカの一意のID         |
| `name`             | String      | トミカの名前             |
| `nfcTagUID`        | String      | NFCタグのユニークID      |
| `createdAt`        | Timestamp   | 登録日時                 |
| `updatedAt`        | Timestamp   | 更新日時                 |
| `isCheckedOut`     | Boolean     | 持ち出し中かどうか       |

---

## 5. 画面設計
### 5.1 ホーム画面
- **概要**: トミカの一覧を表示。
- **要素**:
  - トミカ一覧
  - 検索バー
  - 新規登録ボタン

### 5.2 新規登録画面
- **概要**: 新しいトミカを登録。
- **要素**:
  - トミカ名入力フィールド
  - NFCタグ書き込みボタン
  - 保存ボタン

### 5.3 詳細画面
- **概要**: トミカの詳細情報を表示・編集。
- **要素**:
  - トミカ名
  - NFCタグID
  - 編集ボタン
  - 削除ボタン

---

## 6. メモ
- **NFCタグの読み取り・書き込み**:
  - `react-native-nfc-manager`を使用。
  - 書き込み時はNDEFフォーマットを使用。
- **音声フィードバック**:
  - NFCスキャン時に音声を再生（例: "ピッ"という音）。
- **ARマーカーの検討**:
  - NFCタグの代替案としてARマーカーを検討。
  - 同時に複数のトミカを認識する場合に有効。

---

## 7. 今後の課題
- トミカの金属素材によるNFCタグの読み取り精度の検証。
- 子どもが使いやすいUI/UXの設計。
- バーコードを使用した登録処理の実装検討。